<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
      crossorigin="anonymous"
    ></script>
    <style>
      *,
      *:before,
      *:after {
        box-sizing: border-box;
      }

      body {
        display: flex;
        align-items: center;
        justify-content: center;
        height: auto;
        margin: 0;
        background-image: radial-gradient(circle, #fff 30%, #ccc);
        font-family: sans-serif;
      }

      .textbox {
        position: relative;
        -webkit-transform-style: preserve-3d;
        transform-style: preserve-3d;
        -webkit-animation: turnaround 20s infinite;
        animation: turnaround 20s infinite;
      }

      .textbox-box {
        background-color: #e3f6f5;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: inset 0 0 0 3px #272343;
        position: relative;
        -webkit-animation: hover 2s alternate infinite;
        animation: hover 2s alternate infinite;
        height: 100%;
        -webkit-transform-style: preserve-3d;
        transform-style: preserve-3d;
        transition: all 0.2s ease;
      }

      .textbox-field {
        display: flex;
        flex-direction: column;
        padding: 10px 15px 15px;
        align-self: stretch;
        border-radius: 5px;
      }

      .textbox-label {
        -webkit-transform: translateZ(20px);
        transform: translateZ(20px);
        text-transform: uppercase;
        font-weight: bold;
        -webkit-animation: hover 2s -0.2s alternate infinite;
        animation: hover 2s -0.2s alternate infinite;
        color: #272343;
        -webkit-filter: drop-shadow(0 0 15px rgba(0, 0, 0, 0.5));
      }

      .textbox-action {
        height: 80px;
        width: 80px;
        min-width: 80px;
        margin-right: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        -border-radius: 100px;
        -webkit-transform-style: preserve-3d;
        transform-style: preserve-3d;
        -webkit-animation: hover 2s -0.4s alternate infinite;
        animation: hover 2s -0.4s alternate infinite;
        background-color: #bae8e8;
        position: relative;
        transition: all 0.2s ease;
      }

      .textbox-action svg {
        fill: #272343;
        width: 65%;
        height: 65%;
        -webkit-animation: hover 2s -0.6s alternate infinite;
        animation: hover 2s -0.6s alternate infinite;
        -webkit-filter: drop-shadow(0 0 15px rgba(0, 0, 0, 0.5));
      }

      .textbox-action .textbox-face {
        background-color: #66a8a8;
        transition: all 0.2s ease;
      }

      .textbox-action .textbox-side {
        width: 10px;
      }

      .textbox-action .textbox-bottom,
      .textbox-action .textbox-top {
        height: 10px;
      }

      .textbox-action:hover {
        cursor: pointer;
        background-color: #9ccece;
      }

      .textbox-action:hover .textbox-face {
        background-color: #468282;
      }

      .textbox-text {
        width: 100%;
        height: 100%;
        border: none;
        background-color: transparent;
        font: 2.5rem sans-serif;
        -webkit-animation: hover 2s -0.4s alternate infinite;
        animation: hover 2s -0.4s alternate infinite;
        display: block;
        color: #272343;
        -webkit-filter: drop-shadow(0 0 15px rgba(0, 0, 0, 0.5));
      }

      .textbox-text::-webkit-input-placeholder {
        color: #272343;
        opacity: 0.5;
      }

      .textbox-text:-ms-input-placeholder {
        color: #272343;
        opacity: 0.5;
      }

      .textbox-text::-ms-input-placeholder {
        color: #272343;
        opacity: 0.5;
      }

      .textbox-text::placeholder {
        color: #272343;
        opacity: 0.5;
      }

      .textbox-text:focus {
        outline: none;
      }

      .textbox-face {
        position: absolute;
        background-color: #272343;
        left: 0;
      }

      .textbox-side {
        -webkit-transform: rotateY(90deg);
        transform: rotateY(90deg);
        height: 100%;
        width: 20px;
        top: 0;
        -webkit-transform-origin: 0% 50%;
        transform-origin: 0% 50%;
      }

      .textbox-bottom {
        -webkit-transform: rotateX(90deg);
        transform: rotateX(90deg);
        height: 20px;
        width: 100%;
        bottom: 0;
        -webkit-transform-origin: 50% 100%;
        transform-origin: 50% 100%;
      }

      .textbox-top {
        -webkit-transform: rotateX(-90deg);
        transform: rotateX(-90deg);
        height: 20px;
        width: 100%;
        top: 0;
        -webkit-transform-origin: 50% 0;
        transform-origin: 50% 0;
      }


      .reference {
        position: absolute;
        right: 20px;
        bottom: 15px;
      }

      .reference img {
        width: 35px;
        height: 35px;
      }
      .dataset-selector {
        display: flex;
        align-items: center;
        margin-top: 22px;
      }

      .dataset-selector button {
        margin-left: 10px;
      }

      .selected {
        background-color: rgb(136, 144, 255);
      }
    </style>
  </head>
  <body>
    <div>
      <div class="textbox">
        <div class="textbox-box">
          <div class="textbox-face textbox-side"></div>
          <div class="textbox-face textbox-bottom"></div>
          <div class="textbox-face textbox-top"></div>
          <div class="textbox-field">
            <div class="textbox-label">Article Title</div>
            <input class="textbox-text" type="text" placeholder="Search ..." />
            <div class="dataset-selector">
              <button class="dataset-1-btn">DataSet 1</button>
              <button class="dataset-2-btn">DataSet 2</button>
            </div>
          </div>
          <div class="textbox-action">
            <div class="textbox-face textbox-side"></div>
            <div class="textbox-face textbox-top"></div>
            <div class="textbox-face textbox-bottom"></div>
            <svg class="rida" viewBox="0 0 24 24">
              <path
                d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z"
              ></path>
            </svg>
          </div>
        </div>
      </div>
      <div
        id="search-results"
        style="z-index: 500; margin-top: 400px; margin-right: auto"
      >
        <table class="table table-bordered border-primary" style="width: 500px">
          <thead class="table-dark">
            <tr>
              <th scope="col">text</th>
              <th scope="col">id</th>
            </tr>
          </thead>
          <tbody id="row">
          </tbody>
        </table>
      </div>
    </div>
  </body>
  <script>
    const dataset1Btn = document.querySelector(".dataset-1-btn");
    const dataset2Btn = document.querySelector(".dataset-2-btn");
    const searchInput = document.querySelector(".textbox-text");
    const button = document.querySelector(".rida");
    const row = document.querySelector("#row");

    dataset1Btn.addEventListener("click", () => {
      dataset1Btn.classList.add("selected");
      dataset2Btn.classList.remove("selected");
    });

    dataset2Btn.addEventListener("click", () => {
      dataset2Btn.classList.add("selected");
      dataset1Btn.classList.remove("selected");
    });

    button.addEventListener("click", function () {
      // Get the value of the input field
      const articleTitle = document.querySelector(".textbox-text").value;
      // const searchResults = document.querySelector('#search-results');
      // Get the selected dataset
      let selectedDataset = "";
      if (dataset1Btn.classList.contains("selected")) {
        selectedDataset = "a";
      }
      if(dataset2Btn.classList.contains("selected")){
        selectedDataset = "b";
      }

      row.innerHTML = "";
      // Make an API request
      const xhr = new XMLHttpRequest();
      const url = "http://127.0.0.1:5000/search"; // replace with your backend API endpoint URL
      const params = `query=${articleTitle}&dataset=${selectedDataset}`;
      xhr.open("POST", url, true);
      xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
      xhr.onreadystatechange = function () {
        console.log(selectedDataset)
        if (xhr.readyState === 4 && xhr.status === 200) {
          const response = JSON.parse(xhr.responseText);
          const docResults = response.doc_results_list;

          docResults.forEach((doc) => {
            const tr = document.createElement("tr");
            const td1 = document.createElement("td");
            const td2 = document.createElement("td");

            const words = doc.title ? doc.title.split(" ").slice(0, 10) : []; // split title into words and keep first 10
            td1.textContent = words.join(" ");
          
            td2.textContent = doc.id || "";

            tr.appendChild(td1);
            tr.appendChild(td2);
            row.appendChild(tr);
          });
        }
      };
      xhr.send(params);
    });
  </script>
</html>
